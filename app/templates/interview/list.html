{% extends "base.html" %}

{% block title %}{{ _('Entretiens') }} - {{ site_title }}{% endblock %}

{% block content %}
<div class="page-header">
    <div class="page-header-content">
        <h1>{{ _('Entretiens') }}</h1>
        <p class="text-light">{{ _('Simulations conversationnelles') }}</p>
    </div>
</div>

{% if interviews %}
<div class="grid grid-cols-2 gap-lg">
    {% for interview in interviews %}
    <div class="card">
        <div class="card-body">
            <h3>{{ interview.title }}</h3>
            {% if interview.description %}
            <p class="text-light">{{ interview.description }}</p>
            {% endif %}

            <div class="flex gap-sm mt-md flex-wrap">
                <span class="badge"><i class="iconoir-clock"></i> {{ interview.max_duration_minutes }} {{ _('min') }}</span>
                <span class="badge"><i class="iconoir-chat-bubble"></i> {{ interview.max_interactions }} {{ _('echanges max') }}</span>
                {% if interview.require_file_upload %}
                <span class="badge badge-warning"><i class="iconoir-submit-document"></i> {{ interview.file_upload_label or _('Fichier requis') }}</span>
                {% endif %}
            </div>

            {% if interview.student_context %}
            <div class="mt-md p-md" style="background: var(--bg-secondary); border-radius: 4px;">
                <strong>{{ _('Contexte:') }}</strong>
                <p class="text-light mt-sm">{{ interview.student_context }}</p>
            </div>
            {% endif %}

            {% if interview.student_objective %}
            <div class="mt-sm">
                <strong>{{ _('Objectif:') }}</strong> {{ interview.student_objective }}
            </div>
            {% endif %}

            <div class="mt-lg">
                {% set session = user_sessions.get(interview.id) %}
                {% if session %}
                    {% if session.status == 'completed' %}
                    <div class="flex gap-md items-center">
                        <span class="badge badge-success">{{ _('Complete') }} - {{ "%.0f"|format(session.get_score_percentage()) }}%</span>
                        <a href="{{ url_for('interview.result', identifier=session.get_url_identifier()) }}" class="btn btn-secondary">
                            {{ _('Voir les resultats') }}
                        </a>
                    </div>
                    {% elif session.status == 'in_progress' %}
                    <a href="{{ url_for('interview.chat', identifier=session.get_url_identifier()) }}" class="btn btn-primary">
                        <i class="iconoir-play"></i> {{ _('Reprendre') }}
                    </a>
                    {% elif session.status == 'evaluating' %}
                    <a href="{{ url_for('interview.evaluating', identifier=session.get_url_identifier()) }}" class="btn btn-secondary">
                        <i class="iconoir-refresh rotating"></i> {{ _('Evaluation en cours...') }}
                    </a>
                    {% endif %}
                {% else %}
                <a href="{{ url_for('interview.start', identifier=interview.get_url_identifier()) }}" class="btn btn-primary">
                    <i class="iconoir-play"></i> {{ _('Commencer') }}
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <i class="iconoir-chat-bubble-question"></i>
    <h3>{{ _('Aucun entretien disponible') }}</h3>
    <p>{{ _('Revenez plus tard pour voir les entretiens disponibles.') }}</p>
</div>
{% endif %}
{% endblock %}
